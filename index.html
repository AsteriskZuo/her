<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Her - A High-performence Enhanced Rendering solution by hao123-fe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Her - A High-performence Enhanced Rendering solution</h1>
      <h2 class="project-tagline">Hao123前端高性能渲染解决方案</h2>
      <a href="https://github.com/hao123-fe/her" class="btn">View on GitHub</a>
      <a href="https://github.com/hao123-fe/her/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/hao123-fe/her/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="her---high-performence-enhanced-rendering-hao123前端高性能渲染解决方案" class="anchor" href="#her---high-performence-enhanced-rendering-hao123%E5%89%8D%E7%AB%AF%E9%AB%98%E6%80%A7%E8%83%BD%E6%B8%B2%E6%9F%93%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Her - High-performence Enhanced Rendering Hao123前端高性能渲染解决方案</h1>

<p><a href="https://www.npmjs.com/package/her"><img src="https://img.shields.io/npm/v/her.svg?style=flat-square" alt="npm"></a>
<a href="https://www.npmjs.com/package/her"><img src="https://img.shields.io/npm/dm/her.svg?style=flat-square" alt="npm"></a>
<a href="https://www.npmjs.com/package/her"><img src="https://img.shields.io/npm/l/her.svg?style=flat-square" alt="npm"></a></p>

<p>Her (High-performence Enhanced Rendering) is a Pagelet and Bigpipe like implement, to provide High-performence Rendering in web pages, which inspried by Fackbook's <a href="https://www.facebook.com/notes/facebook-engineering/bigpipe-pipelining-web-pages-for-high-performance/389414033919">BigPipe: Pipelining web pages for high performance</a>.</p>

<p>Her is made up of 3 parts, the build tool, the backend output controller and the frontend render controller. The build tool is based on <a href="http://fis.baidu.com/">FIS</a>. The backend output controllers are  <code>FirstController</code>, <code>QuicklingController</code> and <code>NoScriptController</code>, in which <code>FirstController</code> provide 4 render modes (<code>server|lazy|default|none</code>). And the frontend render controller can load resources and render HTML snippet on demands.</p>

<p>The current implement is for PHP + Smarty. And this repo is the code of the build tool. The backend and frontend runtime code are here - <a href="https://github.com/hao123-fe/her-runtime">her-runtime</a>.</p>

<p>Hao123前端高性能渲染解决方案(Her)是一个为提升页面加载和渲染性能而设计的通用解决方案，实现了 Pagelet 和类 Bigpipe 输出渲染控制。</p>

<p>Her 由编译工具、后端输出控制和前端渲染控制组成，目前提供了基于 PHP 和 Smarty 的实现。其中编译工具基于 <a href="http://fis.baidu.com/">FIS</a> 实现，继承了 FIS 强大的前端构建能力；后端输出控制提供了<code>FirstController|QuicklingController|NoScriptController</code> 3种输出控制器，分别处理基础页请求、局部 Quickling 请求和 NoScript 请求，其中 <code>FirstController</code> 提供 <code>server|lazy|default|none</code> 4种输出模式，方便实现首屏优化、模块开关等；前端渲染控制实现了资源加载、Pagelet 按需渲染和动态打包(planning)。通过对页面进行细粒度分块，收集区块的 HTML 片段、JS、CSS 等资源，后端输出控制和前端按需渲染，极大的增强了前端性能优化的能力。其设计方案和架构图如下：
<img src="https://gss2.bdstatic.com/5eR1dDebRNRTm2_p8IuM_a/res/her/her_runtime.jpg" alt="Her 设计方案">
<img src="https://gss2.bdstatic.com/5eR1dDebRNRTm2_p8IuM_a/res/her/iframework.png" alt="Her 系统架构图"></p>

<p><strong>本仓库为 Her 的构建工具代码，前后端运行时代码见 <a href="https://github.com/hao123-fe/her-runtime">her-runtime</a></strong></p>

<h2>
<a id="docs--get-start" class="anchor" href="#docs--get-start" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://github.com/hao123-fe/her/wiki">Docs</a> &amp;&amp; <a href="https://github.com/hao123-fe/her/wiki/1.Get-start">Get Start</a>
</h2>

<p>Her已经兼容fis-plus，请查看 <a href="https://github.com/hao123-dev/her-preprocessor-fispadaptor">FISP模块迁移文档</a></p>

<h2>
<a id="核心功能" class="anchor" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>核心功能</h2>

<p>Her 通过实现以下核心能力来解决前端性能优化：</p>

<ul>
<li><p><strong>强大的自动化构建能力</strong>。Her 集成了 FIS <code>资源定位、内容嵌入、依赖声明</code> 3种编译构建能力，满足了前端构建需求。</p></li>
<li>
<p><strong>核心运行时能力</strong></p>

<ul>
<li>通过 <code>Pagelet</code> Smarty 插件对页面分块。分块收集 HTML 片段及其依赖的 CSS、JS 资源，对页面模块进行细粒度编码，分解资源依赖和数据获取等</li>
<li>后端输出控制器。后端输出控制提供了<code>FirstController|QuicklingController|NoScriptController</code> 3种输出控制器，分别处理基础页请求、局部 Quickling 请求和 NoScript 请求，其中 <code>FirstController</code> 为 <code>Pagelet</code> 提供了 <code>server|lazy|default|none</code> 4种输出模式，方便实现核心(首屏)模块优先输出、非核心模块延迟输出，模块开关等</li>
<li>前端渲染控制器。实现了 <code>Pagelet</code> 按需加载、渲染，资源及其依赖加载、资源动态化打包(计划中)等</li>
</ul>
</li>
<li>
<p><strong>定制优化方案的能力</strong>，通过对 <code>Pagelet</code> 输出和渲染方式的简单配置编码，可以方便实现以下优化方案和业务方案</p>

<ul>
<li>延迟加载 lazyPagelets。对于非核心模块 <code>Pagelets</code> 后端可以使用 <code>lazy</code> 渲染模式，基础页请求的时候只输出占位标签，基础页渲染完成之后通过 <code>Quickling</code> 方式延迟加载 lazyPagelets，从而实现延迟加载 lazyPagelets，减少基础页 DOM 节点数，极大的优化页面渲染性能。</li>
<li>延迟渲染 bigRender。对于不可见模块可以先不渲染，当用户滚动页面的时候再渲染相应模块。可以进一步提升性能，减少不可见模块的图片和数据接口请求等。</li>
<li>局部刷新 Quickling。对于数据交互频繁的模块，可以通过 <code>BigPipe.fetch()</code> 实现局部刷新，可以实现同构的异步渲染逻辑，极大了降低了异步刷新的开发成本。</li>
</ul>
</li>
</ul>

<h2>
<a id="适用场景" class="anchor" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>适用场景</h2>

<p>Her 适用于采用 Smarty 作为后端模板的 PC 和 Mobile 页面。</p>

<h2>
<a id="参考" class="anchor" href="#%E5%8F%82%E8%80%83" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>参考</h2>

<p><a href="https://www.facebook.com/notes/facebook-engineering/bigpipe-pipelining-web-pages-for-high-performance/389414033919">BigPipe: Pipelining web pages for high performance</a></p>

<p><a href="http://fis.baidu.com/">FIS</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/hao123-fe/her">Her - A High-performence Enhanced Rendering solution</a> is maintained by <a href="https://github.com/hao123-fe">hao123-fe</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
